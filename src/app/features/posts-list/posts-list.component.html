<section class="mx-auto max-w-5xl p-4 space-y-4">
  <header class="flex flex-col sm:flex-row gap-3 sm:items-end" (keydown.enter)="apply()">
    <div class="flex-1 grid grid-cols-1 sm:grid-cols-3 gap-3">
      <input
        class="w-full rounded-xl border px-3 py-2"
        placeholder="Search text"
        [ngModel]="postsStoreService.searchText()"
        (ngModelChange)="filterByText($event)"
      />
      <input
        class="w-full rounded-xl border px-3 py-2"
        placeholder="User ID"
        type="number"
        [ngModel]="postsStoreService.filterUserId()"
        (ngModelChange)="filterByUserId($event)"
      />
      <label class="inline-flex items-center gap-2">
        <input
          type="checkbox"
          [ngModel]="postsStoreService.filterOnlyFavorites()"
          (ngModelChange)="filterByFavorites($event)"
        />
        <span>Only favorites</span>
      </label>
    </div>
    <button
      class="rounded-xl border px-4 py-2 cursor-pointer hover:bg-gray-200 transition duration-400 ease-in-out"
      (click)="apply()"
    >
      Apply
    </button>
  </header>

  <!--  TODO: Move ghost to separate component-->
  @if (postsStoreService.loading()) {
    <div class="space-y-4">
      <div
        class="h-20 w-full animate-pulse rounded-2xl bg-gray-300 hover:bg-gray-400 transition duration-400 ease-in-out"
      ></div>
      <div
        class="h-20 w-full animate-pulse rounded-2xl bg-gray-300 hover:bg-gray-400 transition duration-400 ease-in-out"
      ></div>
      <div
        class="h-20 w-full animate-pulse rounded-2xl bg-gray-300 hover:bg-gray-400 transition duration-400 ease-in-out"
      ></div>
    </div>
  } @else {
    <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4">
      @for (post of postsStoreService.posts(); track post.id) {
        <article
          class="rounded-2xl border p-4 shadow-lg cursor-pointer hover:bg-gray-200 has-[.set-fav:hover]:bg-transparent transition duration-400 ease-in-out"
          (click)="openDetails(post.id)"
        >
          <div class="flex items-start gap-3">
            <h3 class="text-lg font-semibold flex-1 leading-tight">
              {{ post.title }}
            </h3>
            <!--  TODO: Move favourite to separate component-->
            <button
              type="button"
              class="set-fav rounded-full px-3 py-1 text-sm border cursor-pointer hover:bg-gray-200 transition duration-400 ease-in-out"
              (click)="toggleFavorite(post.id); $event.stopPropagation()"
            >
              <!--             TODO: ADD icons for star filled and empty star-->
              {{ postsStoreService.isFavorite(post.id) ? 'mark not fav' : 'mark fav' }}
            </button>
          </div>
          <p class="mt-2 text-sm text-gray-500">
            {{ post.body | slice: 0 : 50 }}{{ post.body.length > 50 ? 'â€¦' : '' }}
          </p>
        </article>
      }
    </div>
  }
</section>
